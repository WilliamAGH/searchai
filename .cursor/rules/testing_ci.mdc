---
description: "CI/CD integration, coverage requirements, and API mocking"
globs: "**/*.{yml,yaml,ts,tsx}"
alwaysApply: true
---

# CI/CD & Integration

## ðŸ”Œ API Mocking (MSW)

### Setup
```typescript
// src/test/mocks/handlers.ts
import { http, HttpResponse } from 'msw'
export const handlers = [
  http.get('/api/chats', () => HttpResponse.json([{ id: '1', title: 'Test' }]))
]

// src/test/setup.ts
import { server } from './mocks/server'
beforeAll(() => server.listen({ onUnhandledRequest: 'error' }))
afterEach(() => server.resetHandlers())
afterAll(() => server.close())
```

## ðŸ“Š Coverage Requirements

### Thresholds
```yaml
Global:
  branches: 80%
  functions: 80%
  lines: 80%
  statements: 80%

Critical Paths (90%+):
  - Auth, Payments, Validation, Security
```

### Exclusions
- `convex/_generated/**`
- `*.d.ts`
- Test files
- Config files

## ðŸš€ CI Workflow (GitHub Actions)

```yaml
jobs:
  unit-tests:
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npm ci
      - run: npm run test:coverage
      
  e2e-tests:
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
      - run: npm ci
      - run: npx playwright install --with-deps
      - run: npx playwright test
```

## ðŸŽ¯ Pre-Commit Checklist

- [ ] Tests pass locally (`npm run test`)
- [ ] Coverage meets thresholds
- [ ] E2E tests pass (`npx playwright test`)
- [ ] No skipped tests
- [ ] No `console.log`
