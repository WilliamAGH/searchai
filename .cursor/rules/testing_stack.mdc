---
description: "Overview of testing stack, critical rules, and philosophy for SearchAI.io"
globs: "**/*.{ts,tsx,test.ts,spec.ts}"
alwaysApply: true
---

# Testing Stack & Philosophy

## üìã Testing Stack Configuration

```yaml
# Testing Tools
UNIT_TEST_FRAMEWORK: Vitest
E2E_TEST_FRAMEWORK: Playwright
COMPONENT_TEST_LIBRARY: React Testing Library
COVERAGE_PROVIDER: V8
API_MOCKING: MSW (Mock Service Worker)

# Node & Runtime
NODE_VERSION: 22 LTS
VITE_VERSION: 6.x
REACT_VERSION: 19.1.x
TYPESCRIPT_VERSION: 5.9.x

# Test Commands
TEST_COMMAND: npm run test
TEST_UI_COMMAND: npm run test:ui
TEST_COVERAGE_COMMAND: npm run test:coverage
TEST_WATCH_COMMAND: npm run test:watch
TEST_E2E_COMMAND: npx playwright test
TEST_SMOKE_COMMAND: npm run test:smoke
```

## üö® CRITICAL TESTING RULES

### NEVER ALLOWED
- ‚ùå **NO** console.log in tests (use debugger or Vitest UI)
- ‚ùå **NO** arbitrary timeouts (use waitFor/findBy)
- ‚ùå **NO** implementation detail testing
- ‚ùå **NO** snapshot tests without review
- ‚ùå **NO** skipped tests in main/dev branches
- ‚ùå **NO** hardcoded test data that can change

### ALWAYS REQUIRED
- ‚úÖ **ALWAYS** test user-visible behavior
- ‚úÖ **ALWAYS** use semantic queries (getByRole, getByLabelText)
- ‚úÖ **ALWAYS** clean up after tests (afterEach hooks)
- ‚úÖ **ALWAYS** mock external dependencies
- ‚úÖ **ALWAYS** test error states and edge cases
- ‚úÖ **ALWAYS** maintain 80%+ coverage

## üéì Testing Philosophy

### The Testing Trophy (2025 Approach)

```
       /\        E2E Tests (10%)
      /  \       - Critical user journeys
     /    \      - Smoke tests
    /------\     Integration Tests (30%)
   /        \    - Component integration
  /          \   - API integration
 /            \  Unit Tests (60%)
/______________\ - Business logic
                 - Utilities
                 - Hooks
```

### Key Principles

1. **Write tests that give confidence**: Focus on critical paths
2. **Test behavior, not implementation**: What the user experiences
3. **Maintain test hygiene**: Keep tests simple, fast, and reliable
4. **Embrace the testing trophy**: More integration tests than the traditional pyramid
5. **Use the right tool**: Unit tests for logic, E2E for workflows
6. **Test accessibility**: Include a11y testing in your workflow
7. **Performance matters**: Monitor test execution time

## üîó Resources & Documentation

### Official Documentation
- [Vitest Documentation](https://vitest.dev/)
- [Playwright Documentation](https://playwright.dev/)
- [React Testing Library](https://testing-library.com/docs/react-testing-library/intro/)
- [MSW Documentation](https://mswjs.io/)

### Recommended Reading
- [Common Testing Mistakes](https://kentcdodds.com/blog/common-mistakes-with-react-testing-library)
- [Test Patterns](https://testingjavascript.com/)
- [Effective Snapshot Testing](https://kentcdodds.com/blog/effective-snapshot-testing)

### Tools & Extensions
- VS Code: Vitest Extension
- VS Code: Playwright Test for VS Code
- Chrome: React Developer Tools
- Chrome: Testing Playground
